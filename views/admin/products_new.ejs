<%- include('../layouts/flash') %>
<h1>Nuovo prodotto</h1>

<form method="post" action="/admin/products" enctype="multipart/form-data" class="form">
  <label>Titolo
    <input type="text" name="title" required />
  </label>

  <label>Categoria
    <select name="category_id" required>
      <option value="">Seleziona…</option>
      <% (cats||[]).forEach(c => { %>
        <option value="<%= c.id %>"><%= c.name %></option>
      <% }) %>
    </select>
  </label>

  <label>Prezzo (€)
    <input type="number" step="0.01" min="0" name="price" required />
  </label>

  <label>Descrizione
    <textarea name="description" rows="6"></textarea>
  </label>

  <label>
    <input type="checkbox" name="is_active" value="1" checked /> Pubblicato
  </label>

  <fieldset>
    <legend>Copertina</legend>
    <label>File immagine (applicheremo il watermark)
      <input type="file" name="image" accept="image/*" />
    </label>
    <div class="or">oppure</div>
    <label>URL immagine (anche esterna – la scarichiamo e watermarkiamo)
      <input type="url" name="image_url" placeholder="https://…" />
    </label>
  </fieldset>

  <fieldset>
    <legend>Galleria</legend>
    <label>File multipli
      <input type="file" name="images" accept="image/*" multiple />
    </label>
    <div class="or">oppure/insieme</div>
    <label>URL (uno per riga)
      <textarea name="image_urls" rows="5" placeholder="https://…\nhttps://…"></textarea>
    </label>
  </fieldset>

  <button class="btn" type="submit">Crea prodotto</button>
  <a class="btn" href="/admin/products">Annulla</a>
</form>

<style>
.form{display:grid;gap:12px;max-width:760px}
label{display:grid;gap:6px}
fieldset{border:1px solid #1f2937;border-radius:10px;padding:12px;display:grid;gap:8px}
legend{padding:0 6px}
.or{opacity:.7;font-size:.9em}
.btn{padding:10px 14px;border-radius:8px;background:#374151;color:#fff;text-decoration:none;border:0;cursor:pointer;width:max-content}
</style>
